\documentclass[10pt,handout]{beamer} %,hyperref={pdfpagelabels=false},draft,handout,handout
\usepackage[orientation=landscape,size=custom,width=16,height=9,scale=0.30,debug]{beamerposter} 
\usepackage[english]{babel}
\usepackage{lmodern}% http://ctan.org/pkg/lm
\usepackage[latin1]{inputenc}
\usepackage{times,hyperref,tikz,colortbl,yfonts,translator}
\usepackage[T1]{fontenc}
 \newcommand{\Q}{\mathbb Q}
 \newcommand{\Z}{\mathbb Z}
 \newcommand{\N}{\mathbb N}
 \newcommand{\F}{\mathbb F}
 \newcommand{\C}{\mathbb C}
 \newcommand{\R}{\mathbb R}
\useoutertheme[height=0pt,width=2cm,right]{sidebar}
\usecolortheme{rose,sidebartab}
\useinnertheme{circles}
\usefonttheme[only large]{structurebold}
\theoremstyle{definition}
\newtheorem{exercise}[theorem]{\translate{Exercise}}
\newtheorem{Note}[theorem]{\translate{Note}}
\lecture[4]{Elliptic curves over finite fields}{Group Structure}
\title[Elliptic curves over $\F_{q}$]{\insertlecture}
\setbeamercolor{formul}{fg=black,bg=pink}
\setbeamercolor{sidebar right}{bg=green!15}
\setbeamercolor{structure}{fg=black!80}
\setbeamercolor{postit}{fg=black,bg=yellow}
\setbeamercolor{greys}{fg=black,bg==black!25}
\setbeamerfont{title in sidebar}{series=\bfseries}
\setbeamerfont*{item}{series=}
\setbeamerfont{frametitle}{size=}
\setbeamerfont{block title}{size=\small}
\setbeamerfont{subtitle}{size=\normalsize,series=\normalfont}
\begin{document}

\begin{frame}
\includegraphics[width=1.6cm]{images/roma3.pdf}\hfill\includegraphics[width=1.9cm]{images/HCMCUS.jpeg}
\vfill

\begin{center}\begin{sc}
\begin{Large}

\textcolor{red}{Elliptic curves over finite fields}
\end{Large}\bigskip

\ {Francesco Pappalardi}\bigskip\bigskip

\begin{large}\begin{bf}\#4 - The group structure
\end{bf}\end{large}\medskip

September $7^{\text{th}}$ 2015\medskip
\vfill
\end{sc}\end{center}

\includegraphics[width=1.6cm]{images/cimpalogo.pdf}\hfill
\begin{minipage}[b]{9.3cm}
\textbf{SEAMS School 2015}\\
\textit{Number Theory and Applications in Cryptography and Coding Theory}\\
University of Science, Ho Chi Minh, Vietnam\\
August 31 - September 08, 2015
\end{minipage}\hfill
\includegraphics[width=1.9cm]{images/seams.png}
\end{frame}

\section{Reminder from Last Lecture}

\begin{frame}\frametitle{Elliptic curves over $\F_q$}

\begin{definition}[Elliptic curve] An elliptic curve over a field $K$ is the data of a non
singular Weierstra\ss\ equation
$E: y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6, a_i\in K$
\end{definition}

If $p=\operatorname{char}K>3$,
\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=\textwidth]{formul}
\begin{align*}
\Delta_E&:=\frac{1}{2^4}\left(-a_1^5 a_3 a_4 - 8 a_1^3 a_2 a_3 a_4 - 16 a_1 a_2^2 a_3 a_4 + 36 a_1^2 a_3^2 a_4 \right. \\
  &-a_1^4 a_4^2 - 8 a_1^2 a_2 a_4^2 - 16 a_2^2 a_4^2 + 96 a_1 a_3 a_4^2 +64 a_4^3 + \\
  & a_1^6 a_6 + 12 a_1^4 a_2 a_6 + 48 a_1^2 a_2^2 a_6 + 64 a_2^3 a_6 -36 a_1^3 a_3 a_6\\
  &\left. - 144 a_1 a_2 a_3 a_6 - 72 a_1^2 a_4 a_6 - 288 a_2 a_4 a_6 +
  432 a_6^2  \right)
 \end{align*}
\end{beamercolorbox}}
\end{frame}


\begin{frame}\frametitle{Elliptic curves over $K$}


After applying a suitable affine transformation we can always assume that $E/K$
has a Weierstra\ss\ equation of the following form

%\begin{small}
 \begin{example}[Classification ($p=\operatorname{char}K$)]
\centerline{\begin{tabular}{|l|c|l|}
\hline
 $E$ & $p$ & $\Delta_E$\\
\hline
&&\\
 $y^2=x^3+Ax+B$ & $\ge5$ & $4A^3+27B^2$\\
&&\\
$y^2+xy=x^3+a_2x^2+a_6$ & $2$ & $a_6^2$\\
&&\\
 $y^2+a_3y=x^3+a_4x+a_6$  & $2$ & $a_3^4$\\
&&\\
 $y^2=x^3+Ax^2+Bx+C$ & $3$ & $\!\begin{array}{l}
                               4A^3C-A^2B^2-18ABC\\+4B^3+27C^2
                              \end{array}$\\
&&\\\hline
\end{tabular}}
\end{example}
%\end{small}\pause

\centerline{\begin{beamercolorbox}[shadow=true,left,rounded=true,wd=\textwidth]{formul}
Let $E/\F_q$ elliptic curve, $\infty$ an extra point. Set\\
\centerline{$E(\F_q)=\{(x,y)\in \F_q^2:\ y^2=x^3+Ax+B\}\cup\{\infty\}$}
\end{beamercolorbox}}
\end{frame}

\begin{frame}

If $P,Q\in E(\F_q), r_{P,Q}:\begin{cases}
                     \text{line through $P$ and }Q &\text{if }P\neq Q\\
                     \text{tangent line to $E$ at }P &\text{if }P=Q,
                    \end{cases}$\\ \ \hfill $r_{P,\infty}:$ vertical line through $P$

\begin{center}
\includegraphics[width=4.9cm]{images/ad15.pdf}\includegraphics[width=4.9cm]{images/add7.pdf}\pause
\end{center}

{$r_{P,\infty}\cap E(\F_q)=\{P,\infty,P'\}$}\hfill$\rightsquigarrow$
{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=2cm]{formul}
             $-P:=P'$
            \end{beamercolorbox}}\medskip

{$r_{P,Q}\cap E(\F_q)=\{P,Q,R\}$}\hfill$\rightsquigarrow$
{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=2.9cm]{formul}
$P+_E Q:=-R$
            \end{beamercolorbox}}
\end{frame}

\begin{frame}
 \begin{Theorem}
 The addition law on $E/K$ ($K$ field) has the following
properties:
\begin{enumerate}[(a)]
 \item  $P+_EQ\in E \hfill\forall P,Q\in E$
 \item  $P+_E\infty=\infty+_E P=P\hfill\forall P\in E$
 \item  $P+_E(-P)=\infty\hfill\forall P\in E$
 \item  $P+_E(Q +_E R)=(P+_E Q)+_E R\hfill\forall P,Q,R\in E$
 \item  $P+_E Q=Q +_E P\hfill\forall P,Q\in E$
\end{enumerate}
So $(E(\bar{K}),+_E)$ is an abelian group.
 \end{Theorem}\pause

 \begin{beamerboxesrounded}[upper=block title example,lower=block body alerted,shadow=true]{Remark:}
If $E/K \ \Rightarrow\ \forall L, K\subseteq L\subseteq\bar{K}, E(L)$ is an abelian group.
\end{beamerboxesrounded}\medskip\pause


\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=6cm]{postit}
$$-P=-(x_1,y_1)=(x_1,-a_1x_1-a_3-y_1)$$
\end{beamercolorbox}}
\end{frame}

\begin{frame}
\frametitle{Formulas for Addition on $E$ (Summary)}
\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=\textwidth]{formul}
$E: y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6$\end{beamercolorbox}}
$P_1 = (x_1, y_1), P_2 = (x_2, y_2)\in E(K)\setminus\{\infty\}$,
\begin{beamerboxesrounded}[upper=block title example,lower=block body alerted,shadow=true]{Addition Laws for the sum of affine points}
\begin{itemize}
 \item If $P_1\neq P_2$
\begin{itemize}
 \item $x_1 = x_2\ \hfill\Rightarrow\hfil$\ \
\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=2cm]{formul}$P_1+_EP_2=\infty$
\end{beamercolorbox}
 \item $x_1\neq x_2$\\
\centerline{\begin{beamercolorbox}[shadow=true,center,wd=4cm]{postit}
             $\lambda=\frac{y_2-y_1}{x_2-x_1}\qquad \nu=\frac{y_1x_2-y_2x_1}{x_2-x_1}$
            \end{beamercolorbox}}
 \end{itemize}
\item If $P_1=P_2$
\begin{itemize}
 \item $2y_1+a_1x+a_3 = 0\ \hfill\Rightarrow\hfil$\ \
\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=3cm]{formul}$P_1 +_E P_2 = 2P_1 = \infty$\end{beamercolorbox}
\item $2y_1+a_1x+a_3\neq 0$\\
\centerline{\begin{beamercolorbox}[shadow=true,center,wd=7cm]{postit}
$\lambda=\frac{3x_1^2+2a_2x_1+a_4-a_1y_1}{2y_1+a_1x+a_3}, \nu=-\frac{a_3y_1+x_1^3-a_4x_1-2a_6}{2y_1+a_1x_1+a_3}$
            \end{beamercolorbox}}
\end{itemize}
\end{itemize}\pause

Then\\
\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=10cm]{formul}
\small{$P_1 +_E P_2 = ({\color[cmyk]{0,1,1,0.5}\lambda^2-a_1\lambda-a_2-x_1-x_2},
{\color[cmyk]{1,0,1,0.5}-\lambda^3-a_1^2\lambda+(\lambda+a_1)(a_2+x_1+x_2)-a_3-\nu})$}
            \end{beamercolorbox}}
\end{beamerboxesrounded}
\end{frame}

\begin{frame}
\frametitle{Formulas for Addition on $E$ (Summary for special equation)}
\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=\textwidth]{formul}
$E: y^2=x^3+Ax+B$\end{beamercolorbox}}
$P_1 = (x_1, y_1), P_2 = (x_2, y_2)\in E(K)\setminus\{\infty\}$,
\begin{beamerboxesrounded}[upper=block title example,lower=block body alerted,shadow=true]{Addition Laws for the sum of affine points}
\begin{itemize}
 \item If $P_1\neq P_2$
\begin{itemize}
 \item $x_1 = x_2\ \hfill\Rightarrow\hfil$\ \ \
\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=2cm]{formul}$P_1 +_E P_2 = \infty$
\end{beamercolorbox}
 \item $x_1 \neq x_2$\\
\centerline{\begin{beamercolorbox}[shadow=true,center,wd=4cm]{postit}
             $\lambda=\frac{y_2-y_1}{x_2-x_1}\qquad \nu=\frac{y_1x_2-y_2x_1}{x_2-x_1}$
            \end{beamercolorbox}}
 \end{itemize}
\item If $P_1 = P_2$
\begin{itemize}
 \item $y_1 = 0\ \hfill\Rightarrow\hfil$\ \ \
\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=3cm]{formul}$P_1 +_E P_2 = 2P_1 = \infty$\end{beamercolorbox}
\item $y_1\neq 0$\\
\centerline{\begin{beamercolorbox}[shadow=true,center,wd=7cm]{postit}
$\lambda=\frac{3x_1^2+A}{2y_1}, \nu=-\frac{x_1^3-Ax_1-2B}{2y_1}$
            \end{beamercolorbox}}
\end{itemize}
\end{itemize}

Then\\
\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=7cm]{formul}
\small{$P_1 +_E P_2 = ({\color[cmyk]{0,1,1,0.5}\lambda^2-x_1-x_2},
{\color[cmyk]{1,0,1,0.5}-\lambda^3+\lambda(x_1+x_2)-\nu})$}
            \end{beamercolorbox}}
\end{beamerboxesrounded}
\end{frame}

\begin{frame}%[label=current]
 \frametitle{Group Structure}

\begin{theorem}[Classification of finite abelian groups]
 If $G$ is {\color[rgb]{0.9,0.3,0.2}{abelian and finite}},  $\exists n_1,\ldots,n_k\in\N^{>1}$ such that
 \begin{enumerate}[<+-| alert@+>]
\item $n_1\mid n_2\mid\cdots\mid n_k$
\item $G\cong C_{n_1}\oplus\cdots\oplus C_{n_k}$
\end{enumerate}
\ \hfill Furthermore $n_1,\ldots,n_k$ ({\color[rgb]{0.9,0.3,0.2} Group Structure}) are unique
 \end{theorem}\pause

\begin{example}[One can verify that:]
 $$C_{2400}\oplus C_{72} \oplus C_{1440}\cong C_{288}\oplus C_{1800}\oplus C_{480}$$
\end{example}\pause

Shall show that
\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=6cm]{formul}
$$E(\F_q)\cong C_n\oplus C_{nk}\qquad\exists n,k\in\N^{>0}$$
            \end{beamercolorbox}}\pause

            (i.e. $E(\F_q)$ is either cyclic ($n=1$) or the product of $2$ cyclic groups)
\end{frame}

\begin{frame}%[label=current2]
 \frametitle{Proof of the associativity}
 \centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=7.3cm]{formul}
             $P+_E(Q+_ER)=(P+_EQ)+_ER\quad\forall P,Q,R\in E$
            \end{beamercolorbox}}\pause
 We should verify the above in many different cases according if $Q=R$, $P=Q$, $P=Q+_ER,\ldots$\pause

Here we deal with the \emph{generic case}. i.e. All the points
\alert{$\pm P, \pm R,\pm Q,\pm(Q+_ER),\pm(P+_EQ),\infty$} all different

\ \hfill {\begin{beamercolorbox}[shadow=true,left,rounded=true,wd=9.6cm]{postit}
 {\small{\color[rgb]{1,0.1,0.1}\texttt{Mathematica code}}\\
\texttt{L[x\_,y\_,r\_,s\_]:=(s-y)/(r-x);\\
M[x\_,y\_,r\_,s\_]:=(yr-sx)/(r-x);\\
A[\{x\_,y\_\},\{r\_,s\_\}]:=\{(L[x,y,r,s])$^2$-(x+r),\\
\ \hfill -(L[x,y,r,s])$^3$+L[x,y,r,s](x+r)-M[x,y,r,s]\}\\
Together[A[A[\{x,y\},\{u,v\}],\{h,k\}]-A[\{x,y\},A[\{u,v\},\{h,k\}]]]\\
det = Det[(\{\{1,x$_1$,x$_1^3$-y$_1^2$\},\{1,x$_2$,x$_2^3$-y$_2^2$\},\{1,x$_3$,x$_3^3$-y$_3^2$\}\})]\\
PolynomialQ[Together[Numerator[Factor[res[[1]]]]/det],\\
\ \hfill\{x$_1$,x$_2$,x$_3$,y$_1$,y$_2$,y$_3$\}]
PolynomialQ[Together[Numerator[Factor[res[[2]]]]/det],\\ \ \hfill\{x$_1$,x$_2$,x$_3$,y$_1$,y$_2$,y$_3$\}]}}
             \end{beamercolorbox}}\pause


% {\begin{beamercolorbox}[shadow=true,left,rounded=true,wd=9.6cm]{postit}
%  \scriptsize{{\color[rgb]{1,0.1,0.1}\texttt{Pari code}}\\
% \texttt{L(a,b,c,d)=(d-b)/(c-a);\\
% M(a,b,c,d)=(b*c-a*d)/(c-a);\\
% AX(a,b,c,d)=L(a,b,c,d)\^{}2-(a+c);\\
% AY(a,b,c,d)=-L(a,b,c,d)\^{}3+L(a,b,c,d)*(a+c)-M(a,b,c,d);\\
% simplify(AX(x1,y1,AX(x2,y2,x3,y3),AY(x2,y2,x3,y3))-\\ \ \hfill AX(AX(x1,y1,x2,y2),AY(x1,y1,x2,y2),x3,y3));\\
% simplify(AY(x1,y1,AX(x2,y2,x3,y3),AY(x2,y2,x3,y3))-\\ \ \hfill AY(AX(x1,y1,x2,y2),AY(x1,y1,x2,y2),x3,y3))}}
% \end{beamercolorbox}}\pause

\begin{small}
\begin{itemize}[<+-| alert@+>]
 \item runs in 2 seconds on a PC
 %\item Complete proof requires several cases (e.g. $(P+_EP)+_ER=P+_E(P+_ER)$)
 \item For an elementary proof:
 ``\text{An Elementary Proof of the Group Law for Elliptic Curves.}''
Department of Mathematics: Rice
University. Web. 20 Nov. 2009.\\ \ \hfill\texttt{http://math.rice.edu/\~{}friedl/papers/AAELLIPTIC.PDF}
\item More cases to check. e.g  \alert{$P+_E2Q=(P+_EQ)+_EQ$}
\end{itemize}
\end{small}
\end{frame}



\section{Examples}
\subsection{Structure of \texorpdfstring{$E(\F_2)$}{E(F2)}}
\begin{frame}
\frametitle{EXAMPLE: Elliptic curves over $\F_2$}

From our previous list:
\begin{block}{Groups of points}

\centerline{
\begin{tabular}{|l|c|l|}
\hline
 $E$ & $E(\F_2)$ & $|E(\F_2)|$\\
\hline
&&\\
 $y^2+xy=x^3+x^2+1$ & $\{\infty,(0,1)\}$& $2$\\
&&\\
$y^2+xy=x^3+1$ & $\{\infty,(0,1),(1,0),(1,1)\}$ & $4$\\
&&\\
$y^2+y=x^3+x$&$\{\infty,(0,0),(0,1), (1,0),(1,1)\}$&$5$\\
&&\\
 $y^2+y=x^3+x+1$ &$\{\infty\}$&$1$\\
&&\\
$y^2+y=x^3$ & $\{\infty,(0,0), (0,1)\}$ & $3$ \\
&&\\\hline
\end{tabular}}
\end{block}
\pause
So for each curve $E(\F_2)$ is cyclic except possibly for the second for which we need to distinguish between
$C_4$ and $C_2\oplus C_2$.\pause

\ \hfill \begin{beamercolorbox}[center,wd=9cm]{postit}
Note: each $C_i, i=1,\ldots,5$ is represented by a curve $/\F_2$
            \end{beamercolorbox}
\end{frame}


\subsection{Structure of \texorpdfstring{$E(\F_3)$}{E(F3)}}
\begin{frame}
\frametitle{EXAMPLE: Elliptic curves over $\F_3$}
From our previous list:

\begin{block}{Groups of points}\centerline{
\begin{tabular}{|l|r|c|c|}
\hline
$i$ & $E_i$ & $E_i(\F_3)$ &$E_i(\F_3)$\\
\hline
$1$& $y^2=x^3+x$ & {$\{\infty,(0,0),(2,1),(2,2)\}$}& $C_4$\\
\hline
$2$&$y^2=x^3 - x$ & {$\{\infty,(1,0),(2,0),(0,0)\}$} & $C_2\oplus C_2$\\
\hline
$3$&$y^2=x^3 - x +1$&{$\{\infty,(0,1),(0,2),(1,1),(1,2),(2,1),(2,2)\}$} & $C_7$\\
\hline
$4$&$y^2=x^3 - x -1$  &{$\{\infty\}$}&$\{1\}$\\
\hline
$5$&$y^2=x^3 + x^2 - 1$ &{$\{\infty,(1,1), (1,2)\}$} & $C_3$ \\
\hline
$6$&$y^2=x^3 + x^2 + 1$ & {$\{\infty,(0,1), (0,2), (1,0),(2,1), (2,2)\}$} & $C_6$ \\
\hline
$7$&$y^2=x^3 - x^2 + 1$ & {$\{\infty,(0,1), (0,2), (1,1), (1,2),\}$} & $C_5$ \\
\hline
$8$&$y^2=x^3 - x^2 - 1$ & {$\{\infty,(2,0))\}$} & $C_2$ \\
\hline
\end{tabular}}
\end{block}
\pause

\ \hfill \begin{beamercolorbox}[center,wd=9cm]{postit}
Note: each $C_i, i=1,\ldots,7$ is represented by a curve $/\F_3$
            \end{beamercolorbox}\pause

            \begin{beamerboxesrounded}[upper=block title example,lower=block body alerted,shadow=true]{Exercise:
            let $\left(\frac{a}{q}\right)$ be the kronecker symbol. 
            Show that the number of non--isomorphic (i.e. inequivalent) classes of elliptic curves over $\F_q$ is }
$$2q+3+\left(\frac{-4}{q}\right)+2\left(\frac{-3}{q}\right)$$
  \end{beamerboxesrounded}
\end{frame}


\subsection{Further Examples}
\begin{frame}
\frametitle{EXAMPLE: Elliptic curves over $\F_5$ and $\F_4$}

$\forall E/\F_5$ (12 elliptic curves), $\#E(\F_5)\in \{2,3,4,5,6,7,8,9,10\}.$ $\forall n, 2\le n\le10 \exists! E/\F_5: \#E(\F_5)=n$
%each number corresponds to a unique curve
with the exceptions:

\begin{example}[Elliptic curves over $\F_5$]
\begin{itemize}[<+-| alert@+>]
 \item \alert{$E_1: y^2=x^3+1$} and \alert{$E_2: y^2=x^3+2$}\hfill both order $6$\\
 \begin{columns}
\begin{column}{4cm}
\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=2.5cm]{postit}
        $\begin{cases}
x\longleftarrow 2x\\
y\longleftarrow \sqrt{3}y
  \end{cases}$\end{beamercolorbox}
 \end{column}
 \begin{column}{5cm}
$E_1$ and $E_2$ affinely equivalent over $\F_5[\sqrt{3}]=\F_{25}$ (\emph{twists})
 \end{column}
 \end{columns}
\item \alert{$E_3: y^2=x^3+x$} and \alert{$E_4: y^2=x^3+x+2$}
\hfill order $4$
$$E_3(\F_5)\cong C_2\oplus C_2\qquad E_4(\F_5)\cong C_4$$
\item \alert{$E_5: y^2=x^3+4x$} and \alert{$E_6: y^2=x^3+4x+1$}
\hfill both order $8$
$$E_5(\F_5)\cong C_2\oplus C_4\qquad E_6(\F_5)\cong C_8$$
\item \alert{$E_7: y^2=x^3+x+1$}\hfill  order $9$ and $E_7(\F_5)\cong C_9$
\end{itemize}
\end{example}\pause\vspace*{-3pt}
\begin{beamerboxesrounded}[upper=block title example,lower=block body alerted,shadow=true]{\textbf{Exercise:} Classify all elliptic curves over $\F_4=\F_2[\xi], \xi^2=\xi+1$}
 \end{beamerboxesrounded}
\end{frame}

\section{the \texorpdfstring{$j$}{j}-invariant}
\begin{frame}
\frametitle{The $j$-invariant}
Let  $E/K: y^2=x^3+Ax+B$, $p\ge5$ and $\Delta_E:=4A^3+27B^2$. \pause

\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=9.2cm]{postit} $\begin{cases}
x\longleftarrow u^{-2} x\\
y\longleftarrow u^{-3} y
  \end{cases} u\in K^*\ \Rightarrow\ E\longrightarrow E_u: y^2=x^3+u^4Ax+u^6B$
  \end{beamercolorbox}\pause

\begin{definition} The $j$--invariant of $E$ is
$j=j(E)=1728\frac{4A^3}{4A^3+27B^2}$
\end{definition}

\begin{beamerboxesrounded}[upper=block title example,lower=block body alerted,shadow=true]{Properties of
$j$--invariants}
\begin{enumerate}[<+-| alert@+>]
  \item $j(E)=j(E_u), \forall u\in K^*$
  \item $j(E'/K)=j(E''/K)\ \Rightarrow\ \exists u\in\bar{K}^*$ s.t. $E''=E'_u$
  \item[\ ] \ \hfill if $K=\F_q$ can take $u\in\F_{q^{12}}$
  \item $j\ne 0,1728\Rightarrow E: y^2=x^3+\frac{3j}{1728-j}x+\frac{2j}{1728-j},$ $j(E)=j$
  \item $j=0\ \Rightarrow\ E: y^2=x^3+B,\quad j=1728\ \Rightarrow\ E: y^2=x^3+Ax$
  %\item The above have more isomorphism that usual ($6$ and $4$ respectively)
  \item $j: K\leftarrow\!\rightarrow\{\bar{K}$--affinely
  equivalent classes of $E/K\}$.
  \item $p=2, 3$ different definition
\end{enumerate}
\end{beamerboxesrounded}
\end{frame}

\begin{frame}
\frametitle{Examples of $j$ invariants}

From Friday \alert{$E_1: y^2=x^3+1$} and \alert{$E_2: y^2=x^3+2$}\pause

\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=9cm]{formul}
$\#E_1(\F_5)=\#E_2(\F_5)=6\qquad$ and $\qquad j(E_1)=j(E_2)=0$
\end{beamercolorbox}

\begin{columns}
\begin{column}{4cm}
\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=2.5cm]{postit}
        $\begin{cases}
x\longleftarrow 2x\\
y\longleftarrow \sqrt{3}y
  \end{cases}$\end{beamercolorbox}
 \end{column}
 \begin{column}{5cm}
$E_1$ and $E_2$ affinely equivalent over $\F_5[\sqrt{3}]=\F_{25}$ (\emph{twists})
 \end{column}
 \end{columns}\pause

\begin{definition}[twisted curve] Let $E/\F_q: y^2=x^3+Ax+B, \mu\in\F_q^*\setminus(\F_q^*)^2$.
$$E_\mu: y^2=x^3+\mu^2Ax+\mu^3B$$ is called \alert{twisted curve.}
\end{definition}\pause

\begin{beamerboxesrounded}[upper=block title example,lower=block body alerted,shadow=true]{Exercise: prove that}
\begin{itemize}[<+-| alert@+>]
  \item $j(E)=j(E_\mu)$
  \item $E$ and $E_\mu$ are $\F_q[\sqrt{\mu}]$--affinely equivalent
  \item $\#E(\F_{q^2})=\#E_\mu(\F_{q^2})$
  \item usually $\#E(\F_{q})\neq\#E_\mu(\F_{q})$
\end{itemize}
\end{beamerboxesrounded}
\end{frame}


\section{Points of finite order}

\subsection{Points of order 2}
\begin{frame}\frametitle{Determining points of order $2$}
Let $P=(x_1,y_1)\in E(\F_q)\setminus\{\infty\},$\\ \pause
\centerline{
 \begin{beamercolorbox}[rounded=true,shadow=true,wd=9cm,center]{formul}
$P$ has order $2\ \Longleftrightarrow\ 2P=\infty\ \Longleftrightarrow\ P=-P$
\end{beamercolorbox}}\pause
So
\centerline{\small{
 \begin{beamercolorbox}[rounded=true,shadow=true,wd=10cm,center]{formul}
$-P=(x_1,-a_1x_1-a_3-y_1)=(x_1,y_1)=P\ \pause \Longrightarrow\ 2y_1=-a_1x_1-a_3$\end{beamercolorbox}}}\pause\medskip

If $p\neq2$, can assume $E: y^2=x^3+Ax^2+Bx+C$\pause

\centerline{\small{
 \begin{beamercolorbox}[rounded=true,shadow=true,wd=10cm,center]{formul}
$-P=(x_1,-y_1)=(x_1,y_1)=P\ \pause \Longrightarrow\ y_1=0,
x_1^3+Ax_1^2+Bx_1+C=0$\hfill
\end{beamercolorbox}}}\pause\medskip

\begin{Note}
\begin{itemize}[<+-| alert@+>]
 \item the number of points of order $2$ in $E(\F_q)$ equals the number of roots of $X^3+Ax^2+Bx+C$ in $\F_q$
 \item roots are distinct since discriminant $\Delta_E\neq0$
 \item $E(\F_{q^6})$ has always $3$ points of order $2$ if $E/\F_q$
 \item $E[2]:=\{P\in E(\bar{\F}_q): 2P=\infty\}\cong C_2\oplus C_2$
\end{itemize}
\end{Note}

% $\begin{cases}
%    2y=-a_1x-a_3\\
%    y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6
%   \end{cases}\longrightarrow$, $\begin{cases}
%    2y=-a_1x-a_3\\
%    x^3+(a_2+a_1^2/4)x^2+(a_4+a_1a_3/2)x+a_6+a_3^2/4=0
%   \end{cases}$

\end{frame}

\begin{frame}\frametitle{Determining points of order $2$ (continues)}

\begin{itemize}[<+-| alert@+>]
\item If $p=2$ and $E: y^2+a_3y=x^3+a_2x^2+a_6$\pause

 \begin{beamercolorbox}[rounded=true,shadow=true,wd=10cm,center]{formul}
$-P=(x_1,a_3+y_1)=(x_1,y_1)=P\ \pause \Longrightarrow\ a_3=0$\end{beamercolorbox}\pause\medskip

Absurd ($a_3=0$) and there are no points of order $2$.
%$\begin{cases}
 %  x=a_3/a_1\\
  % y^2+a_1xy+a_3y+x^3+a_2x^2+a_4x+a_6=0
  %\end{cases}\longrightarrow$,
\item If $p=2$ and $E: y^2+xy=x^3+a_4x+a_6$\pause

 \begin{beamercolorbox}[rounded=true,shadow=true,wd=10cm,center]{formul}
$-P=(x_1,x_1+y_1)=(x_1,y_1)=P\ \pause \Longrightarrow\ x_1=0,y_1^2=a_6$\end{beamercolorbox}\pause\medskip

So there is exactly one point of order $2$ namely $(0,\sqrt{a_6})$
\end{itemize}\pause

\begin{Definition}{$2$--torsion points}
$$E[2]=\{P\in E: 2P=\infty\}.$$
\end{Definition}
In conclusion
$$E[2]\cong \begin{cases}
C_2\oplus C_2 &\text{if }p>2\\
C_2           &\text{if }p=2, E: y^2+xy=x^3+a_4x+a_6\\
\{\infty\}    &\text{if }p=2, E: y^2+a_3y=x^3+a_2x^2+a_6
\end{cases}
$$

\end{frame}

\begin{frame}
\frametitle{Elliptic curves over $\F_2, \F_3$ and $\F_5$}
\begin{block}{Each curve $/\F_2$ has cyclic $E(\F_2)$.}
\centerline{\begin{tabular}{|l|c|l|}
\hline
 $E$ & $E(\F_2)$ & $|E(\F_2)|$\\
\hline
 $y^2+xy=x^3+x^2+1$ & $\{\infty,(0,1)\}$& $2$\\
\hline
$y^2+xy=x^3+1$ & $\{\infty,(0,1),(1,0),(1,1)\}$ & $4$\\
\hline
$y^2+y=x^3+x$&$\{\infty,(0,0),(0,1),(1,0),(1,1)\}$&$5$\\
\hline
$y^2+y=x^3+x+1$ &$\{\infty\}$&$1$\\
\hline
$y^2+y=x^3$ & $\{\infty,(0,0), (0,1)\}$ & $3$ \\
\hline
\end{tabular}}
\end{block}
\pause
\begin{itemize}
 \item $E_1: y^2=x^3+x\qquad\qquad E_2:  y^2=x^3-x$\\
\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=7.5cm]{formul}
$E_1(\F_3)\cong C_4\qquad\text{and}\qquad E_2(\F_3)\cong C_2\oplus C_2$
\end{beamercolorbox}}
\item $E_3: y^2=x^3+x\qquad\qquad E_4: y^2=x^3+x+2$\\
\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=7.5cm]{formul}
$E_3(\F_5)\cong C_2\oplus C_2\qquad\text{and}\qquad E_4(\F_5)\cong C_4$
\end{beamercolorbox}}
\item $E_5: y^2=x^3+4x\qquad\qquad E_6: y^2=x^3+4x+1$\\
\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=7.5cm]{formul}
$E_5(\F_5)\cong C_2\oplus C_4\qquad\text{and}\qquad E_6(\F_5)\cong C_8$
\end{beamercolorbox}}
\end{itemize}
\end{frame}

\subsection{Points of order 3}
\begin{frame}\frametitle{Determining points of order $3$}
Let  $P=(x_1,y_1)\in E(\F_q)$
\centerline{
 \begin{beamercolorbox}[rounded=true,shadow=true,wd=9cm,center]{formul}
$P$ has order $3\ \Longleftrightarrow\ 3P=\infty\ \Longleftrightarrow\ 2P=-P$
\end{beamercolorbox}}\pause\smallskip

So, if $p>3$ and $E: y^2=x^2+Ax+B$\\
 \begin{beamercolorbox}[rounded=true,shadow=true,wd=9cm,center]{postit}
$2P=(x_{2P},y_{2P})=2(x_1,y_1)=({\color[cmyk]{0,1,1,0.5}\lambda^2-2x_1},
{\color[cmyk]{1,0,1,0.5}-\lambda^3+2\lambda x_1-\nu})$
\end{beamercolorbox}\pause\smallskip
\hfill where
$\lambda=\frac{3x_1^2+A}{2y_1}, \nu=-\frac{x_1^3-Ax_1-2B}{2y_1}$.\pause

 \begin{beamercolorbox}[rounded=true,shadow=true,wd=5.5cm,center]{formul}
$P$ has order $3\ \Longleftrightarrow\ x_{2P}=x_1$
\end{beamercolorbox}\pause%\smallskip

\centerline{
 \begin{beamercolorbox}[rounded=true,shadow=true,wd=9cm,center]{formul}
Substituting $\lambda$,\quad \pause\ $x_{2P}-x_1=\frac{-3x_1^4-6Ax_1^2-12Bx_1+A^2}{4(x_1^3+Ax_1+4B)}=0$
\end{beamercolorbox}}\pause

\begin{Note}
\begin{itemize}[<+-| alert@+>]
 \item $\psi_3(x):= 3x^4+6Ax^2+12Bx-A^2$ the $3^{\text{rd}}$ \emph{division} polynomial
 \item $(x_1,y_1)\in E(\F_q)$ has order $3\quad \Rightarrow \psi_3(x_1)=0$
 \item $E(\F_q)$ has at most $8$ points of order $3$
 \item If $p\neq 3$, $E[3]:=\{P\in E: 3P=\infty\}\cong C_3\oplus C_3$
\end{itemize}
 \end{Note}
\end{frame}

\begin{frame}\frametitle{Determining points of order $3$ (continues)}

\begin{exercise} Let $E: y^2=x^3+Ax^2+Bx+C, A,B,C\in\F_{3^n}$. Prove that if $P=(x_1,y_1)\in E(\F_{3^n})$
has order $3$, then
\begin{enumerate}[<+-| alert@+>]
 \item $Ax_1^3+AC-B^2=0$
 \item $E[3]\cong C_3$ if $A\neq0$ and $E[3]=\{\infty\}$ otherwise
\end{enumerate}
\end{exercise}\pause

\begin{example}[from Friday]
If $E: y^2=x^3+x+1$, then $\#E(\F_5)=9$.\pause
$$\psi_3(x)=(x + 3)(x + 4)(x^2 + 3x + 4)$$
Hence
\centerline{$E[3]=\left\{
\infty,(2,\pm1),(1,\pm\sqrt{3}),(1\alert{\pm}2\sqrt{3},\pm(1\alert{\pm}\sqrt{3}))\right\}$}\pause
\begin{enumerate}[<+-| alert@+>]
 \item $E(\F_5)=\{\infty,(2,\pm1),(0,\pm1),(3,\pm1),(4,\pm2)\}\cong C_9$
 \item Since $\F_{25}=\F_5[\sqrt{3}]\quad\Rightarrow\quad  E[3]\subset E(\F_{25})$
 \item $\#E(\F_{25})=27\quad\Rightarrow\quad E(\F_{25})\cong C_3\oplus C_9$
\end{enumerate}


\end{example}
\end{frame}

\begin{frame}\frametitle{Determining points of order $3$ (continues)}

%\begin{small}
\begin{block}{Inequivalent curves $/\F_7$ with $\#E(\F_7)=9$.}
\begin{tabular}{|l|c|c|c|}
\hline
 $E$ & $\psi_3(x)$ & $E[3]\cap E(\F_7)$ & $\!\!\!E(\F_7)\cong\!\!\!$\\
\hline
 $\!\!y^2=x^3+2\!\!$ & $x(x + 1)(x + 2)(x + 4)$ &$\!\!\!\left\{
\infty,(0,\pm3),(-1,\pm1), (5,\pm1),(3,\pm1)\right\}\!\!$
& $\!\!\!C_3\oplus C_3\!\!\!$\\
\hline
$\!\!y^2=x^3+3x+2\!\!$ & $\!\!(x + 2)(x^3 + 5x^2 + 3x + 2)\!\!$ & $\{\infty,(5,\pm3)\}$ & $C_9$ \\
\hline
$\!\!y^2=x^3+5x+2\!\!$ & $\!\!(x + 4)(x^3 + 3x^2 + 5x + 2)\!\!$ & $\{\infty,(3,\pm3)\}$ & $C_9$ \\
\hline
$\!\!y^2=x^3+6x+2\!\!$ & $\!\!(x + 1)(x^3 + 6x^2 + 6x + 2)\!\!$ & $\{\infty,(6,\pm3)\}$ & $C_9$ \\
\hline
\end{tabular}
\end{block}%\end{small}
\pause

\begin{block}
{Can one count the number of inequivalent $E/\F_q$ with $\#E(\F_q)=r$?}
%\pause \ \hfill \alert{Answer:} \pause Next Time!!
\end{block}

\begin{example}[A curve over $\F_4=\F_2(\xi), \xi^2=\xi+1;\qquad E: y^2+y=x^3$]\pause
 We know $E(\F_2)=\{\infty, (0,0), (0,1)\}\subset E(\F_4).$\pause\\
 \begin{scriptsize}$E(\F_4)=\{\infty,(0,0),(0,1),(1,\xi),(1,\xi+1),(\xi,\xi),(\xi,\xi+1),
 (\xi+1,\xi),(\xi+1,\xi+1)\}$\end{scriptsize} \pause

\begin{small}\centerline{
\begin{beamercolorbox}[rounded=true,shadow=true,wd=7cm,center]{postit}
$\psi_3(x)=x^4+x=x(x+1)(x+\xi)(x+\xi+1)\Rightarrow E(\F_4)\cong C_3\oplus C_3$
\end{beamercolorbox}}
\end{small}
\end{example}

\begin{exercise}[Suppose $(x_0,y_0)\in E/\F_{2^n}$ has order $3$. Show that]
\begin{enumerate}[<+-| alert@+>]
  \item $E: y^2+a_3y=x^3+a_4x+a_6\ \Rightarrow\ x_0^4+a_3^2x_0+(a_4a_3)^2=0$
  \item $E: y^2+xy=x^3+a_2x^2+a_6\ \Rightarrow\ x_0^4+x_0^3+a_6=0$
\end{enumerate}
\end{exercise}

%\begin{scriptsize}
%\begin{block}{Inequivalent curves $/\F_8$ with $\#E(\F_8)=9$.}
%\begin{tabular}{|l|c|c|c|}
%\hline
% $E$ & $\psi_3(x)$ & $E[3]\cap E(\F_8)$ & $\!\!\!E(\F_8)\cong\!\!\!$\\
%\hline
% $\!\!y^2=x^3+2\!\!$ & $x(x + 1)(x + 2)(x + 4)$ &$\!\!\!\left\{\!\!\!\begin{array}{l}
%\infty,(0,\pm3),(-1,\pm1),\!\!\! \\ (5,\pm1),(3,\pm1)\end{array}\!\!\!\!\right\}\!\!$
%& $\!\!\!C_3\oplus C_3\!\!\!$\\
%\hline
%\end{tabular}
%\end{block}\end{scriptsize}

\end{frame}

\subsection{Points of finite order}

\begin{frame}\frametitle{Determining points of order (dividing) $m$}\pause
\begin{definition}[$m$--torsion point] Let $E/K$ and let $\bar{K}$ an \emph{algebraic closure of $K$}.

\centerline{\begin{beamercolorbox}[rounded=true,shadow=true,wd=5cm,center]{postit}
$E[m]=\{P\in E(\bar{K}):\ mP=\infty\}$\end{beamercolorbox}}
\end{definition}\pause

\begin{theorem}[Structure of Torsion Points]
Let $E/K$  and $m\in\N$. If $p=\operatorname{char}(K)\nmid m$,\pause

\centerline{\begin{beamercolorbox}[rounded=true,shadow=true,wd=3.5cm,center]{formul}
$E[m]\cong C_m\oplus C_m$\end{beamercolorbox}}

If $m=p^rm', p\nmid m'$,

\centerline{\begin{beamercolorbox}[rounded=true,shadow=true,wd=8cm,center]{formul}
$E[m]\cong C_m\oplus C_{m'}\qquad\text{or}\qquad E[m] \cong C_{m'}\oplus C_{m'}$\end{beamercolorbox}}
\end{theorem}\pause

\begin{block}\ \hfill
$E/\F_p$ is called $\begin{cases} \text{\emph{ordinary}} &\text{ if }E[p]\cong C_p\\
                \text{\emph{supersingular}} &\text{ if }E[p]=\{\infty\}
                    \end{cases}$\end{block}
\end{frame}

\subsection{The group structure}
\begin{frame}\frametitle{Group Structure of $E(\F_q)$}

\begin{corollary} Let $E/\F_q$. $\exists n,k\in\mathbb N$ are such that
\centerline{\begin{beamercolorbox}[rounded=true,shadow=true,wd=6cm,center]{formul}
$$E(\F_q)\cong C_n\oplus C_{nk}$$\end{beamercolorbox}}
\end{corollary}\pause

\begin{proof}
From classification Theorem of finite abelian group\\
\centerline{$E(\F_q)\cong  C_{n_1}\oplus C_{n_2}\oplus\cdots\oplus C_{n_r}$}
with $n_i|n_{i+1}$ for $i\ge1$.\pause

Hence $E(\F_q)$ contains $n_1^r$ points of order dividing $n_1$. From
\emph{Structure of Torsion Theorem}, $\#E[n_1]\le n_1^2$.
So $r\le2$\end{proof}\pause

\begin{theorem}[Corollary of Weil Pairing]  Let $E/\F_q$ and $n,k\in\mathbb N$ s.t.
$E(\F_q)\cong C_n\oplus C_{nk}.$
Then $n\mid q-1$.
\end{theorem}\pause

\ \hfil We shall discuss the proof of the latter tomorrow
\end{frame}


\section{sketch of proof}

\begin{frame}\frametitle{Sketch of the proof of Structure Theorem of Torsion Points}
\framesubtitle{The division polynomials}\pause

The proof generalizes previous ideas and determine the points $P\in E(\F_q)$ such that
$mP=\infty$ or equivalently $(m-1)P=-P$.


\begin{Definition}[Division Polynomials of $E:y^2=x^3+Ax+B$ ($p>3$)]\vspace*{-0.7cm}
\begin{align*}
        \psi_{0} =& 0\\
        \psi_{1} =& 1\\
        \psi_{2} =& 2y\\
        \psi_{3} =& 3x^{4} + 6Ax^{2} + 12Bx - A^{2}\\
        \psi_{4} =& 4y(x^{6} + 5Ax^{4} + 20Bx^{3} - 5A^{2}x^{2} - 4ABx - 8B^{2} - A^{3}) \\
        &\vdots\\
        \psi_{2m+1} =& \psi_{m+2}\psi_{m}^{3}-\psi_{m-1}\psi^{3}_{m+1} \qquad \text{ for } m \geq 2\\
        \psi_{2m}  =& \left(\frac{\psi_{m}}{2y}\right)\cdot(\psi_{m+2}\psi^{2}_{m-1}-\psi_{m-2}\psi^{2}_{m+1}) \quad \text{ for } m \geq 3
\end{align*}
The polynomial $\psi_m\in{\mathbb Z}[x,y]$ is called the $m^{\text{th}}$ \emph{division polynomial}
\end{Definition}

\end{frame}


\begin{frame}\frametitle{The division polynomials}

\begin{lemma} Let $E: y^2=x^3+Ax+B$, ($p>3$) and let $\psi_m\in{\mathbb Z}[x,y]$ the $m^{\text{th}}$ \emph{division polynomial}. Then
\centerline{\begin{beamercolorbox}[rounded=true,shadow=true,wd=7cm,center]{formul}
$\psi_{2m+1}\in\mathbb{Z}[x]\qquad\text{and}\qquad\psi_{2m}\in 2y\mathbb{Z}[x]$\end{beamercolorbox}}
\end{lemma}\pause

\begin{proof}[Proof is an exercise] True $\psi_0,\psi_1,\psi_2,\psi_3,\psi_4$ and for the rest apply induction,
the identity $y^2=x^3+Ax+B\cdots$ and consider the cases $m$ odd and $m$ even.
\end{proof}\pause

\begin{lemma}
\centerline{\begin{beamercolorbox}[rounded=true,shadow=true,wd=8cm,center]{formul}
$\psi_m=\begin{cases} y(mx^{(m^2-4)/2}+\cdots) &\text{if $m$ is even}\\
mx^{(m^2-1)/2}+\cdots &\text{if $m$ is odd.}\end{cases}$
\end{beamercolorbox}}
Hence $\psi_m^2=m^2x^{m^2-1}+\cdots$
\end{lemma}\pause

\begin{proof}[Proof is another exercise on induction:]\end{proof}
\end{frame}

\begin{frame}
\begin{theorem}[$E: Y^2=X^3+AX+B$ elliptic curve, $P=(x,y)\in E$]\pause
\centerline{\begin{beamercolorbox}[rounded=true,shadow=true,wd=10.2cm,center]{formul}
$$\!\!\!m(x,y)=\left(x - \frac {\psi_{m-1} \psi_{m+1}}{\psi_{m}^{2}(x)}, \frac{\psi_{2 m}(x,y)}{2\psi_{m}^{4}(x)} \right)=\left ( \frac{\phi_{m}(x)}{\psi_{m}^{2}(x)}, \frac{\omega_{m}(x,y)}{\psi^{3}_{m}(x,y)} \right)
\!\!\!$$\end{beamercolorbox}}\pause
where
\centerline{\begin{beamercolorbox}[rounded=true,shadow=true,wd=8.5cm,center]{formul}
 $\phi_{m}=x\psi_{m}^{2} - \psi_{m+1}\psi_{m-1},\omega_{m}=\frac{\psi_{m+2}\psi_{m-1}^{2}-\psi_{m-2}\psi_{m+1}^{2}}{4y}$
 \end{beamercolorbox}}
\end{theorem}\pause

We will omit the proof of the above (see \cite[Section 9.5]{washington})\pause

\begin{exercise}[Prove that after substituting $y^2=x^3+Ax+B$]
\begin{enumerate}[<+-| alert@+>]
  \item $\phi_m(x)\in\Z[x]$
  \item $\phi_m(x)=x^{m^2}+\cdots$\qquad $\psi_m(x)^2=m^2x^{m^2-1}+\cdots$
  \item $\omega_{2m+1}\in y\Z[x]$, $\omega_{2m}\in\Z[x]$
  \item $\frac{\omega_{m}(x,y)}{\psi^{3}_{m}(x,y)} \in y\Z(x)$
  \item $\gcd(\psi_m^2(x),\phi_m(x))=1$\\ \quad\quad
  \alert{this is not really an exercise!! - see \cite[Corollary 3.7]{washington}} \vspace*{-3.5pt}
\end{enumerate}
\end{exercise}
\end{frame}

\begin{frame}
\begin{lemma}
\centerline{\begin{beamercolorbox}[rounded=true,shadow=true,wd=8cm,center]{formul}
$\#E[m]=\#\{P\in E(\bar{K}): mP=\infty\}\begin{cases}=m^2&\text{if }p\nmid m\\
<m^2&\text{if }p\mid m\end{cases}$
 \end{beamercolorbox}}
\end{lemma}

\begin{proof} Consider the homomorphism:\\
\centerline{\alert{$[m]:E(\bar{K})\rightarrow E(\bar{K}), P\mapsto mP$}}\pause

If $p\nmid m$, need to show that \\
\centerline{\alert{$\#\operatorname{Ker}[m]=\#E[m]=m^2$}}\pause
\medskip

We shall prove that
$\exists P_0=(a,b)\in [m](E(\bar{K}))\setminus\{\infty\}$ s.t.\\
\centerline{\alert{$\#\{P\in E(\bar{K}):\ mP=P_0\}=m^2$}}\pause
\medskip

Since $E(\bar{K})$ infinite, we can choose $(a,b)\in [m](E(\bar{K}))$ s.t. %\vspace*{-7mm}
\begin{enumerate}[<+->]
  \item \alert{$ab\neq0$}
  \item \alert{$\forall x_0\in\bar{K}:
(\phi_m'\psi_m-2\phi_m\psi_m')(x_0)\psi_m(x_0)=0\Rightarrow a\ne \frac{\phi_{m}(x_0)}{\psi_{m}^{2}(x_0)}$}\\
\qquad if $p\nmid m$, conditions imply that \alert{$\phi_m(x)-a\psi_m^2(x)$}\\ \qquad has
$m^2=\partial(\phi_m(x)-a\psi_m^2(x))$ distinct roots\\
\qquad in fact $\partial \phi_m(x)=m^2$ and $\partial\psi_m^2(x)=m^2-1$\vspace*{-5mm}
\end{enumerate}
\end{proof}
\end{frame}

\begin{frame}
\begin{proof}[Proof continues]
Write

\centerline{\alert{$mP=m(x,y)=\left(\frac{\phi_m(x)}{\psi_m^2(x)},\frac{\omega_m(x,y)}{\psi_m(x)^3}\right)=
\left(\frac{\phi_m(x)}{\psi_m^2(x)},{y r(x)}\right)$}}\medskip\pause

The map

\alert{\centerline{$\{\alpha\in\bar{K}: \phi_m(\alpha)-a\psi_m(\alpha)^2=0\}\leftrightarrow\{P\in E(\bar{K}): mP=(a,b)\}$}}
\alert{\centerline{$\alpha_0\mapsto(\alpha_0,br(\alpha_0)^{-1})$}}\medskip

is a well defined bijection.\medskip\pause

Hence there are $m^2$ points $P\in E(\bar{K})$ with $mP=(a,b)$\medskip\pause

So there are $m^2$ elements in $\operatorname{Ker}[m].$\medskip\medskip\pause

If $p\mid m$, the proof is the same except that $\phi_m(x)-a\psi_m(x)^2$
has multiple roots!!

In fact $\phi_m'(x)-a\psi_m'(x)^2=0$
\end{proof}
\end{frame}


\begin{frame}\frametitle{From Lemma, Theorem follows:}
If $p\nmid m$, apply classification Theorem of finite Groups:
\alert{$$E[m]\cong C_{n_1}\oplus C_{n_2}\oplus\cdots C_{n_k},$$}
$n_i\mid n_{i+1}$. Let $\ell\mid n_1$, then $E[\ell]\subset E[m]$. Hence
$\ell^k=\ell^2\ \Rightarrow\ k=2$. So
\alert{$$E[m]\cong C_{n_1}\oplus C_{n_2}$$}\pause

Finally $n_2\mid m$ and $n_1n_2=m^2$ so $m=n_1=n_2$.\medskip \pause

If $p\mid m$, write $m=p^jm'$, $p\nmid m'$ and
\alert{$$E[m]\cong E[m']\oplus E[p^j]\cong C_{m'}\oplus C_{m'}\oplus E[p^j]$$}

The statement follows from:

\centerline{\alert{$E[p^j]\cong \begin{cases}
                  \{\infty\} \\
                  C_{p^j}
                \end{cases}$}\qquad and \qquad \alert{$ C_{m'}\oplus C_{p^j}\cong C_{m'p^j}$}}\pause

which is done by induction.
%                Proof: see \cite[page 86]{washington}
\end{frame}

\begin{frame}\frametitle{From Lemma, Theorem follows (continues)}

Induction base:
\centerline{\alert{$E[p]\cong \begin{cases}
                  \{\infty\} \\
                  C_{p}
                \end{cases}$}\pause\qquad \alert{if follows from } $\#E[p]<p^2$}\pause

\begin{itemize}[<+->]
\item If \alert{$E[p]=\{\infty\}\ \Rightarrow\ E[p^j]=\{\infty\}\ \forall j\ge2$}:

In fact if $E[p^j]\neq\{\infty\}$ then it would contain some element of order $p$\pause (contradiction).

\item If \alert{$E[p]\cong C_p$, then $E[p^j]\cong C_{p^j}\ \forall j\ge2$}:

In fact $E[p^j]$ is cyclic (otherwise $E[p]$ would not be cyclic!)\pause

\centerline{\begin{beamercolorbox}[shadow=true,center,rounded=true,wd=\textwidth]{postit}
\textbf{Fact:} \alert{$[p]: E(\bar{K})\ \rightarrow\ E(\bar{K}$)} is surjective
(to be proven tomorrow) \end{beamercolorbox}}\pause

If $P\in E$ and $\operatorname{ord}P=p^{j-1}\ \Rightarrow\ \exists Q\in E$ s.t. $pQ=P$ and
$\operatorname{Q}=p^{j}$.

Hence $E[p^j]\cong C_{p^j}$ since it contains an element of order $p^j$.
\end{itemize}
%We know that $P\in E[m]$ if and only if $(m-1)P=-P$. By the Theorem we need
%to count the $P\in E$ such that $\psi_{m-2} \psi_{m}=0$.
%If $m=2n+1$,

\begin{beamerboxesrounded}[upper=block title example,lower=block body alerted,shadow=true]{Remark:}
\begin{itemize}
\item $E[2m+1]\setminus \{\infty\}= \{(x,y)\in E(\bar{K}):\  \psi_{2m+1}(x)=0\}$
\item $E[2m]\setminus E[2]= \{(x,y)\in E(\bar{K}):\  y^{-1}\psi_{2m}(x)=0\}$
\end{itemize}
\end{beamerboxesrounded}


\end{frame}

%Statement is correct for $n=1, 2, 3, 4$.
%$$nP=(n-1)P+_EP=(\lambda^2-x,).$$
%
%
%
% The $\ell$-torsion group of $E/\bar{\F}_q$ is isomorphic to
%$E[\ell]\cong \begin{cases}
%               C_\ell\oplus C_\ell &  \text{if }\ell\neq p\\
%C_\ell\text{ or } \{\infty\} &\text{ if }\ell=p.
%              \end{cases}$
%Hence the degree of $\psi_\ell$ is equal to either $\frac{1}{2}(\ell^2-1)$, $\frac{1}{2}(\ell-1)$, or $0$.

\section{Important Results}
\subsection{Hasse's Theorem}
\begin{frame}
\begin{theorem}[Hasse]
Let $E$ be an elliptic curve over the finite field $\F_q$. Then the order of $E(\F_q)$
satisfies
$$\left|q+1-\#E(\F_q)\right|\le 2\sqrt q.$$
\end{theorem}\pause

So \alert{$\#E(\F_q)\in [(\sqrt q -1)^2, (\sqrt q+1)^2]$} the \emph{Hasse interval} ${\mathcal I}_q$


 \begin{example}[Hasse Intervals]
\begin{scriptsize}
 \centerline{\begin{tabular}{|l|l|}
\hline
 $q$ & ${\mathcal I}_q$\\
\hline
$2$ & $\{1, 2, 3, 4, 5\}$\\
$3$ & $\{1, 2, 3, 4, 5, 6, 7\}$\\
$4$ & $\{1, 2, 3, 4, 5, 6, 7, 8, 9 \}$\\
$5$ & $\{2, 3, 4, 5, 6, 7, 8, 9, 10\}$\\
$7$ & $\{3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13\}$\\
$8$ & $\{4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14\}$\\
$9$ & $\{4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16\}$\\
$11$ & $\{6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18\}$\\
$13$ & $\{7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21\}$\\
$16$ & $\{9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25\}$\\
$17$ & $\{10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26\}$\\
$19$ & $\{12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28\}$\\
$23$ & $\{15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32,
 33\}$\\
$25$ & $\{16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
 34, 35, 36\}$\\
$27$ & $\{18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
 36, 37, 38\}$\\
$29$ & $\{20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37,
 38, 39, 40\}$\\
$31$ & $\{21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,
 39, 40, 41, 42, 43 \}$\\
$32$ & $\{22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,
 40, 41, 42, 43, 44\}$\\  \hline
\end{tabular}}
\end{scriptsize}
\end{example}



\end{frame}

\subsection{Waterhouse's Theorem}
\begin{frame}[label=current]
\begin{theorem}[Waterhouse]\pause
\label{lem:Water}
 Let $q=p^n$ and let $N = q + 1-a$.\\
\centerline{$\exists E/\F_q\text{ s.t.}\#E(\F_q) = N\Leftrightarrow|a|\le 2\sqrt q\text{ and}$}
 one of the following is satisfied:\pause
\begin{itemize}[<+-| alert@+>]
\item[(i)] $\gcd(a, p) = 1$;
\item[(ii)] $n$ even and one of the following is satisfied:
\begin{enumerate}
  \item $a=\pm 2\sqrt q$;
  \item $p\not\equiv 1 \pmod 3$, and $a = \pm\sqrt q$;
  \item $p\not\equiv 1 \pmod 4$, and $a = 0$;
\end{enumerate}
\item[(iii)] $n$ is odd, and one of the following is satisfied:
 \begin{enumerate}
   \item $p = 2$ or $3$, and $a = \pm p^{(n+1)/2}$;
   \item $a = 0$.
 \end{enumerate}
 \end{itemize}
\end{theorem}

%\setbeamercovered{transparent}

\begin{example}[$q$ prime $\forall N\in I_q,\exists E/\F_q, \#E(\F_q)=N.$ $q$ not prime:]
\begin{small}
\centerline{\begin{tabular}{|l|l|}
\hline
 $q$ & $a\in$\\
\hline%\vspace*{-3.12pt}
\!\!$4=2^2$\!\! &\!\!\!\! $\{{\color<5->{green}-4},{\color<3->{green}-3},{\color<6->{green}-2},{\color<3->{green}-1},{\color<7->{green}0},{\color<3->{green}1},{\color<6->{green}2}, {\color<3->{green}3}, {\color<5->{green}4}\}$\\
\!\!$8=2^3$\!\! &\!\!\!\! $\{{\color<3->{green}-5},{\color<9->{green}-4},{\color<3->{green}-3},-2,{\color<3->{green}-1},{\color<10->{green}0},{\color<3->{green}1},2,{\color<3->{green}3}, {\color<9->{green}4},{\color<3->{green}5}\}$\\
\!\!$9=3^2$\!\! &\!\!\!\! $\{{\color<5->{green}-6},{\color<3->{green}-5},{\color<3->{green}-4},{\color<6->{green}-3},{\color<3->{green}-2},{\color<3->{green}-1},{\color<7->{green}0},{\color<3->{green}1},{\color<3->{green}2}, {\color<6->{green}3},{\color<3->{green}4},{\color<3->{green}5},{\color<5->{green}6}\}$\\
\!\!$16=2^4$\!\! &\!\!\!\! $\{{\color<5->{green}-8},{\color<3->{green}-7},-6,{\color<3->{green}-5},{\color<6->{green}-4},{\color<3->{green}-3},-2,{\color<3->{green}-1},{\color<7->{green}0},{\color<3->{green}1},2,{\color<3->{green}3}, {\color<6->{green}4},{\color<3->{green}5}, 6,{\color<3->{green}7},{\color<5->{green}8}\}$\\
\!\!$25=5^2$\!\! &\!\!\!\! $\{{\color<5->{green}-10},{\color<3->{green}-9},{\color<3->{green}-8},{\color<3->{green}-7},{\color<3->{green}-6},{\color<6->{green}-5},{\color<3->{green}-4},{\color<3->{green}-3},{\color<3->{green}-2},{\color<3->{green}-1},0,{\color<3->{green}1},{\color<3->{green}2}, {\color<3->{green}3}, {\color<3->{green}4},{\color<6->{green}5},{\color<3->{green}6},{\color<3->{green}7}, {\color<3->{green}8},{\color<3->{green}9}, {\color<3->{green}10}\}$\\
\!\!$27=3^3$\!\! &\!\!\!\! $\{{\color<3->{green}-10},{\color<9->{green}-9},{\color<3->{green}-8},{\color<3->{green}-7},-6,{\color<3->{green}-5},{\color<3->{green}-4},-3,{\color<3->{green}-2},{\color<3->{green}-1},{\color<10->{green}0},{\color<3->{green}1},{\color<3->{green}2}, 3, {\color<3->{green}4},{\color<3->{green}5},6,{\color<3->{green}7},{\color<3->{green}8},{\color<9->{green}9},{\color<3->{green} 10}\}$\!\!\!\!\\
\!\!$32=2^5$\!\!&\!\!\!\! $\{{\color<3->{green}-11},-10,{\color<3->{green}-9},{\color<9->{green}-8},{\color<3->{green}-7},-6,{\color<3->{green}-5},-4,{\color<3->{green}-3},-2,{\color<3->{green}-1},{\color<10->{green}0},{\color<3->{green}1},2, {\color<3->{green}3}, 4,{\color<3->{green}5}, 6, {\color<3->{green}7}, {\color<9->{green}8}, {\color<3->{green}9},10,{\color<3->{green}11}\}$\!\!\!\!\\  \hline
\end{tabular}}\end{small}
\end{example}
\end{frame}

\subsection{R\"uck's Theorem}
\begin{frame}
\begin{theorem}[R\"uck]
Suppose $N$ is a possible order of an elliptic curve $/\F_q$,  $q=p^n$.  Write

\centerline{
$N = p^e n_1 n_2,\quad p\nmid n_1 n_2\quad\text{and}\quad n_1\mid n_2\ (\text{possibly }n_1 = 1).$}

There exists $E/\F_q$ s.t.
$$E(\F_q)\cong C_{n_1}\oplus C_{n_2p^e}$$
if and only if
\begin{enumerate}[<+-| alert@+>]
\item $n_1 = n_2$ in the case~(ii).1 of Waterhouse's Theorem;
\item $n_1 |q - 1$ in all other cases of  Waterhouse's Theorem.
\end{enumerate}
\end{theorem}\pause

\begin{example}
\begin{itemize}[<+->]
\item If $q=p^{2n}$ and $\#E(\F_q)=q+1\pm2\sqrt{q}=(p^n\pm1)^2$, then

\alert{\centerline{$E(\F_q)\cong C_{p^n\pm1}\oplus C_{p^n\pm1}.$}}
\item Let $N=100$ and $q=101\ \Rightarrow\ \exists E_1, E_2, E_3, E_4/\F_{101}$ s.t.

\alert{\centerline{$E_1(\F_{101})\cong C_{10}\oplus C_{10}\qquad E_2(\F_{101})\cong C_{2}\oplus C_{50}$}}

\alert{\centerline{$E_3(\F_{101})\cong C_{5}\oplus C_{20}\qquad E_4(\F_{101})\cong C_{100}$}}

\end{itemize}
\end{example}
\end{frame}



\section{Further reading}
\begin{frame}
\frametitle{Further Reading...}
\begin{scriptsize}
\begin{thebibliography}{99}
\bibitem{BSS} \textsc{Ian~F.~Blake,~Gadiel~Seroussi,~and~Nigel~P.~Smart},
Advances in elliptic curve cryptography, London Mathematical Society Lecture Note Series, vol. 317, Cambridge University Press, Cambridge, 2005.
 \bibitem{C} \textsc{J.~W.~S.~Cassels},
Lectures on elliptic curves, London Mathematical Society Student Texts, vol. 24, Cambridge University Press, Cambridge, 1991.
 \bibitem{CR} \textsc{John~E.~Cremona},
Algorithms for modular elliptic curves, 2nd ed., Cambridge University Press, Cambridge, 1997.
 \bibitem{Kn} \textsc{Anthony~W.~Knapp},
Elliptic curves, Mathematical Notes, vol. 40, Princeton University Press, Princeton, NJ, 1992.
 \bibitem{Ko} \textsc{Neal~Koblitz},
Introduction to elliptic curves and modular forms, Graduate Texts in Mathematics, vol. 97, Springer-Verlag, New York, 1984.
 %\bibitem{Po} \textsc{Poonen B} Elliptic curves (introduction)(19s) notes
 \bibitem{Sil} \textsc{Joseph~H.~Silverman},
The arithmetic of elliptic curves, Graduate Texts in Mathematics, vol. 106, Springer-Verlag, New York, 1986.
\bibitem{ST} \textsc{Joseph~H.~Silverman~and~John~Tate},
Rational points on elliptic curves, Undergraduate Texts in Mathematics, Springer-Verlag, New York, 1992.
\bibitem{washington} \textsc{Lawrence~C.~Washington},
Elliptic curves: Number theory and cryptography, 2nd ED. Discrete Mathematics and Its Applications, Chapman \& Hall/CRC, 2008.
\bibitem{Zimm} \textsc{Horst~G.~Zimmer},
Computational aspects of the theory of elliptic curves, Number theory and applications
(Banff, AB, 1988) NATO Adv. Sci. Inst. Ser. C Math. Phys. Sci., vol. 265, Kluwer Acad. Publ., Dordrecht, 1989, pp. 279--324.
\end{thebibliography}
\end{scriptsize}
\end{frame}
\end{document}

